<!DOCTYPE html>
<html>
<head>
<title>{{ title }}</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
  #map_canvas { height: 100% }
</style>

<script src="http://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&sensor=true" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>
<script src="/static/js/jquery.ui.map.full.min.js" type="text/javascript"></script>

</head>
<body >
<div id="map_canvas" style="width:100%; height:100%"></div>
<script type="text/javascript">

$(function() {
    // This URL won't work on your localhost, so you need to change it
    // see http://en.wikipedia.org/wiki/Same_origin_policy
    $.getJSON( '/json', function(data) { 
      $.each( data.markers, function(i, marker) {
        $('#map_canvas').gmap('addMarker', { 
          'position': new google.maps.LatLng(marker.latitude, marker.longitude), 
          'bounds': true 
        }).click(function() {
          $('#map_canvas').gmap('openInfoWindow', { 'content': marker.content }, this);
        });
      });
    });
  });

</script>

</body>
</html>
